选题背景意义
---



《瘟疫危机：浪潮汹涌》是一款有趣的多人合作类桌游。这次大作业目标则是开发这款桌游的程序端复刻。

这个题目的选择主要基于如下的考虑：

1	相对原版实体桌游的优势：
1.1	原版桌游的售价昂贵（京东售价在本文写作时是358元人民币[1]）。对很多桌游新人来说价格高昂；
1.2	原版桌游有各式棋子，地图，因而体积庞大。玩家需要足够的场地收藏和玩。而且便携性不佳，不易在旅途中等移动场景中享受桌游的乐趣；
2	桌游规则对程序开发的简化：
2.1	游戏元素具有离散性质。方便程序利用变量刻画，并且有限，至多枚举解决；
2.2	游戏中事件的触发具有随机性（原版桌游中是抽牌触发）。这使得程序编写时不需要考虑与玩家对抗的脚本逻辑，算法等编写问题；
2.3	作为一个多人合作，信息彼此公开的游戏。本质上只需一名玩家控制所有角色。因而程序可以省略玩家间合作所需要的网络通信部份，只需编写对单人的界面；


### 同类产品调研分析

本桌游暂时没有软件端版本。但是同类型的桌游（如瘟疫危机）是有线上版本。线上版本在AppStore上架。同类产品的主要优势有
1. 画面相对精美丰富；
2. 拥有联机模式，可与好友对战

**本产品相比同类竞品，将实现的创意之处则在于**

1. 在默认三种难度以外，允许自定义参数。例如自定义某些重要游戏参数，留下重要事件触发后门等。给高手玩家增加挑战性。同时能帮助新手玩家降低挫败感；
2.	本游戏互动界面交互语言采用简体中文[2]，相比原游戏对国内用户更加友好；

### 功能设计细节

游戏性质构想

给与后门手段（暂行），spc中输入cheat
近乎无限水方块，大坝，排水厂码头


**地图要素**
可以看出，地图被分为离散的区域。
本程序需要实现对每块地图区域状态的记录和交互。这些重要信息包括：
+ 区域自身信息（28个低海拔，水可流动人可进入地区，6个高地，只有人可进入以及两片海洋；陆地地区分别属于4个大地区）
+ 区域和其他区域之间的联通状态（是或否，人物移动和水流动需要此判定）
+ 区域水量（0-3之间整数）
+ 区域大坝情况（单独每个位点的大坝存在与否）
+ 区域上的人物，建筑信息（存在哪几个人，是否有建筑，建筑种类）
+ 记录全局水位（用2-4的离散整数表示）

**水流**
+ 总共36个水方块
- 外海水位：2格对应一到三级，3格对应四到六级，4格对应七级及以上，初始为一级，海洋地区水方块对应水位
- 一次浪潮侵袭：=当有大坝时，破坏一个地区的任意（玩家选择）大坝；否则，该地区增长一个水方块
- 联通（水意义上）：=地理联通+没有大坝阻隔在边界上
- 一次水流动结算：=每一个具有两个及以上水方块的地区（包括海洋），在与它所有联通地区放置水方块直至这些地区的水方块数为原地区水方块数减1，（反之无需处理）。
- 洪水：=水流动结算时，当一个地区已有3个水方块，又需要在这个地区放置一个新的水方块时，不放置这个水方块，而是在与这个地区所有联通（水意义上）地区各放置一个水方块，若其他地区因此拥有了大于3个水方块，需连锁结算洪水。

### 人物以及能力

**人物属性：**
- 所处地区
- 手牌信息
- 特殊职业技能在操作面板上实现

**职业技能**

港口管理员
>花费一点行动在所在地区建立港口，不耗费地区牌   从有港口地区花费一点行动，可传送到任何地区

仓库管理员
>在有港口地区，花费一点行动，将自己任意一张地区牌交给任意一玩家

主管
>花费一点行动，将任意一玩家传送到有水的任意地区

木匠
>花费一点行动在所在地区建立排水厂，不耗费地区牌  可在有水地区建造大坝

水泵工人
>排水行动时可选择临近地区排一个水 如果这样，还可以排本地区一格水

水利工程师
>建造大坝时可一次建造两座

卫生工程师
>花费一点行动，将自己所在小地区的特定的小地区牌回自己手牌

**牌堆系统和手牌系统**

- 存在两个牌库系统：浪潮牌和地区牌，每个系统都有牌堆和弃牌堆
- 浪潮牌系统由2*28对应地区的浪潮侵袭牌
- 地区牌系统由2*28对应地区的地区牌和14张特殊事件牌构成以及若干风暴牌（初始参数决定）构成
- 游戏开始时，牌库中卡牌进行随机排列。而地区牌系统中，对于n张风暴牌，地区牌均分为n段，每张风暴牌分别随机插入一段中
- 风暴牌：抽到时触发，效果依次为
1.	海平面水位上升一格；
2.	从浪潮牌底抽取一张浪潮牌，对该地区三次浪潮侵袭；
3.	浪潮弃牌堆的浪潮牌随机排列后回到浪潮牌系统顶部；

- 特殊事件牌
海洋协会
>移动任意一玩家到与海洋临近地区	

信件交换
>任意两玩家交换各自一手牌

荷兰男孩
>选择任意一地区，本回合洪水流动时不得新的水方块	新港口	任意一地区放置一港口一大坝（无视是否有水）

紧急会议
>任意一玩家传送到任意一玩家地区	
用水管理
>合法下移动任意三个水方块

风雨将至
>将浪潮牌系统中的顶部五张牌中的所有风暴牌置于牌堆顶，其他顺序不变

堵住裂缝
>选择任意一玩家，其地区所有空大坝位均获得新的大坝（无视是否有水）

工程小队
>玩家本回合额外多3个行动

沙袋战术
>跳过本回合浪潮侵袭判定

暴风电报
>任意一玩家1-2张手牌交给任意玩家

水利委员会
>排除任意3个水方块

三角洲计划
>任意位置放置3个大坝（无视是否有水）

工业博物馆
>任意一地区放置一排水厂一大坝（无视是否有水）

**初始化**
1. 选择模式或自定义各个参数

2. 放置初始大坝，水方块

3.1 从浪潮牌堆中依次抽取3张浪潮牌，对对应地区进行3次浪潮侵袭（摧毁大坝/增加水方块）

3.2 再依次抽取3张浪潮牌，对对应地区进行2次浪潮侵袭

3.3 再依次抽取3张浪潮牌，对对应地区进行1次浪潮侵袭，抽出的9张浪潮牌作为浪潮牌弃牌堆，剩余浪潮牌成为浪潮牌堆（在此阶段不触发洪水）

4.	根据初始化参数，将地区牌和特定数量（默认值或自定义值）特殊事件牌随机排列，各玩家抽取特定数量手牌

5.	初始化浪潮牌系统

6.	结算洪水流动

**活动** （暂不考虑特殊技能）

-	回合以玩家做单位循环
-	回合顺序
1.	玩家活动，
2.	排水（有排水厂时），
3.	抽两张地区牌，抽到风暴牌立即结算，不补抽
4.	抽取海平面水位量的浪潮牌，对对应小地区进行一次浪潮侵袭
5.	结算水流动
##### 玩家活动选项如下，一回合至多能进行4次活动，可以少进行，重复进行，次数不累加 
1)	移动到相邻区域
2)	弃掉一张小地区牌，移动到对应地区
3)	移动到任意一个码头
4)	弃掉当前小地区的地区牌，移动到任意地区
5)	弃掉当前小地区的地区牌，在当前地区建造码头
6)	弃掉当前小地区的地区牌，在当前地区建造排水厂
7)	移除当前小地区的一个水方块
8)	在当前小地区建造一个大坝（当前地区必须没有水方块）
9)	给与/索取与你处于同一大地区的一个角色的一张地区牌，这张地区牌必须是你当前所在小地区的地区牌
10) 弃掉5张同一大地区手牌，建造水利设施（必须处在对应的地区）
11）某些职业技能
##### 特殊行动：=在任意角色的任意阶段给与特殊活动选项，不计算活动次数
1）	使用事件牌（在结算过程中不能使用）
2）	内置后门操作（允许在结算中使用）

##### 大坝，建筑以及水利工程

-	总共50个大坝，5个码头，5个排水厂
-	建造设施超总数时“拆东墙补西墙”
-	相邻水系：=当一个地区与相邻的某个地区满足以下两个条件：1.都具有水方块。2.两个地区间无大坝阻隔。则称这两个地区处于相邻水系中。
-	排水：=在排水阶段中，每一个排水厂可移除自己所在地区或者与自己所在地区处于相邻水系中的任意地区的一个水方块
-	水利设施：=4座，每座建造时拥有特殊能力，并立即结算

三角洲工程	
>特定五个沿海地区建造大坝（无视是否水）

阿夫鲁戴克大坝
>须德海地区属性由海洋变为低海拔地区

标准化工程
>黄色大地区放置至多4个大坝

河流缓冲带

>绿色大地区排除至多6个水方块

##### 胜利与失败条件
-	胜利条件：完成四座水利设施。
-	失败条件：地区牌堆被抽光或当需要放置水方块而没有多余水方块可以放置时

##### 界面设置
-	本游戏主要采用命令行窗口。
-	应当提供完整的菜单列表，和完整的玩家信息列表
-	上述显示函数应当通过某些快捷键快速调用，方便玩家在各个阶段查看信息
-	提供操作和事件发生的log文件日志记录功能

